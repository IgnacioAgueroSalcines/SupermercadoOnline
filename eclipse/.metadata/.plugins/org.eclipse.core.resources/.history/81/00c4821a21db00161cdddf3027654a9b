package supermercadoOnline.web;

import java.io.Serializable;

import javax.annotation.Resource;
import javax.annotation.security.DeclareRoles;
import javax.annotation.security.RolesAllowed;
import javax.ejb.EJB;
import javax.ejb.SessionContext;
import javax.enterprise.context.SessionScoped;
import javax.inject.Named;

import es.unican.ps.supermercadoOnline.domain.Usuario;
import es.unican.ps.supermercadoOnline.utils.IRegistroUsuarioRemote;

@Named("supermercadoOnlineIndexBean")
@SessionScoped
@DeclareRoles({"USUARIOREGISTRADO","GERENTE","DEPENDIENTE","USUARIO"})
public class SupermercadoOnlineIndexBean implements Serializable{
	/**
	 * 
	 */
	private static final long serialVersionUID = 1L;

	@Resource
	private SessionContext ctx;

	@EJB
	private IRegistroUsuarioRemote remote;

	//valores vinculados a los facelets
	private String nombreCliente;


	@RolesAllowed("USUARIOREGISTRADO")
	public String getNombreCliente() {
		return nombreCliente;
	}


	@RolesAllowed("USUARIOREGISTRADO")
	public void setNombreCliente(String nombreCliente) {
		this.nombreCliente = nombreCliente;
	}



	//metodos de accion
	@RolesAllowed("USUARIOREGISTRADO")
	public String add(){
		String res ="index.xhtml";
		switch(ctx.getCallerPrincipal().getName()){
		case "GERENTE":
			res="gerencia.xhtml";
			break;
		case "USUARIO":
			res="iniciaCompra.xhtml";
			break;
		case "DEPENDIENTE":
			res="iniciaCompra.xhtml";
			break;
		case "USUARIOREGISTRADO":
			Usuario res2 = new Usuario();
			res2.setNombre(nombreCliente);
			remote.addUsuario(res2);
			res="iniciaCompra.xhtml";
			break;
		default:
			

		}
		
		return res;
	}
}
